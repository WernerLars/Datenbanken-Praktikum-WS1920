-- Aufgabe 9
WITH plays_in(NAME, MOVIEID) AS (
    SELECT a.name, m2a.movieid
    FROM dbmaster.actors AS a
         JOIN dbmaster.movies2actors AS m2a
         ON a.actorid = m2a.actorid
), 

kevin_bacon(ACTOR, BACON_NUMBER) AS (
    SELECT p2.name, 0
    FROM plays_in AS p1 JOIN plays_in AS p2
         ON p1.movieid = p2.movieid
    WHERE p1.name = 'Bacon, Kevin (I)' AND
          p2.name != 'Bacon, Kevin (I)'

    UNION ALL

    SELECT p.name, kb.bacon_number+1
    FROM kevin_bacon AS kb, plays_in AS p
    WHERE p.name = kb.actor AND
          kb.bacon_number < 2
)

SELECT DISTINCT * FROM kevin_bacon;
