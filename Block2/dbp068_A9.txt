-- Aufgabe 9

WITH ACTORNAMES(NAME , ACTORID , MOVIEID) AS (
    SELECT A.NAME , A.ACTORID , M2A.MOVIEID
    FROM DBMASTER.ACTORS AS A 
         JOIN 
         DBMASTER.MOVIES2ACTORS AS M2A
         ON A.ACTORID = M2A.ACTORID
),

KEVIN_BACON(NAME , ACTORID , BACON_NUMBER) AS (
        SELECT NAME , ACTORID , 0 AS BACON_NUMBER
        FROM ACTORNAMES
        WHERE NAME = 'Bacon, Kevin (I)'	

    UNION ALL	

        SELECT AN2.NAME , AN2.ACTORID , KB.BACON_NUMBER + 1		
        FROM KEVIN_BACON AS KB , ACTORNAMES AS AN1 ,  ACTORNAMES AS AN2
        WHERE KB.ACTORID = AN1.ACTORID AND
              AN1.MOVIEID = AN2.MOVIEID AND
              AN1.ACTORID <> AN2.ACTORID AND		      
              KB.BACON_NUMBER < 2
)

SELECT DISTINCT NAME , MIN(BACON_NUMBER)
FROM KEVIN_BACON 
GROUP BY NAME;
